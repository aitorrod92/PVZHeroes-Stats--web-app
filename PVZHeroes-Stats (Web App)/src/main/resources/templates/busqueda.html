<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">

<head>
<title>PVZHeroes-Stats (web app)</title>
<!-- Required meta tags -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
	crossorigin="anonymous">
<link th:href="@{/CSS.css}" href="/CSS.css" rel="stylesheet"
	type="text/css" />
<script src="https://code.jquery.com/jquery-3.5.1.min.js"
	type="text/javascript"></script>
</head>

<body>
	<br>
	<div class="elementoConMargen">
		<h1>Queries in PVZHeroes database</h1>
	</div>
	<br>
	<div class="elementoConMargen" style="font-weight: bold;">
		NÃºmero de filtros <select class="elementoConMargen"
			id="comboNumeroFiltros" th:field="${comboNumeroFiltros.valor}">
			<option value="">--</option>
			<option
				th:each="entry : ${comboNumeroFiltros.opcionesSeleccion.entrySet()}"
				th:value="${entry.value}" th:utext="${entry.key}"></option>
		</select>
	</div>
	<br>

	<table class="elementoConMargen" id="tablaCombos">
		<thead>

			<th>Filtro 1</th>
			<th hidden class="tituloAdicional">Filtro 2</th>
			<th hidden class="tituloAdicional">Filtro 3</th>
			<th hidden class="tituloAdicional">Filtro 4</th>
		</thead>
		<tbody>
			<tr>
				<td><form name='f' th:object="${combinacionCC1}"
						th:action="@{/busqueda}" method='POST'>
						<select id="comboAtributos1"
							th:field="${combinacionCC1.comboboxA.valor}">
							<option value="">--</option>
							<option
								th:each="entry : ${combinacionCC1.comboboxA.opcionesSeleccion.entrySet()}"
								th:value="${entry.value}" th:utext="${entry.key}"></option>
						</select> <select id="comboOperadores1"
							th:field="${combinacionCC1.comboboxOperadores.valor}">
							<option value="">--</option>
						</select> <input autofocus type="text" id="input1"
							th:field="${combinacionCC1.carta.Valor}" placeholder="Nombre"
							class="form-control mb-4 col-4">
						<button type="submit">Buscar</button>
					</form></td>

				<td><form hidden class="filtroAdicional" name='f'
						th:object="${combinacionCC2}" th:action="@{/busqueda}"
						method='POST'>
						<select id="comboAtributos2"
							th:field="${combinacionCC2.comboboxA.valor}">
							<option value="">--</option>
							<option
								th:each="entry : ${combinacionCC2.comboboxA.opcionesSeleccion.entrySet()}"
								th:value="${entry.value}" th:utext="${entry.key}"></option>
						</select> <select id="comboOperadores2"
							th:field="${combinacionCC2.comboboxOperadores.valor}">
							<option value="">--</option>
						</select> <input autofocus type="text"
							th:field="${combinacionCC2.carta.Valor}" placeholder="Ataque"
							class="form-control mb-4 col-4">
						<button type="submit">Buscar</button>
					</form></td>
			</tr>
		</tbody>
	</table>




	<br>
	<table
		class="table table-hover table-dark table-bordered table-striped">
		<thead>
			<tr>
				<th>Nombre</th>
				<th>Ataque</th>
				<th>Defensa</th>
				<th>Coste</th>
				<th>Clase</th>
				<th>Tribus</th>
				<th>Atributos</th>
				<th>Habilidades</th>
				<th>Rareza</th>
				<th>Mazo</th>
				<th>Tipo</th>
				<th>NumeroAtributos</th>
			</tr>
		</thead>

		<tbody>
			<tr>
				<td><span><a th:href="${cartaBuscada.URL}"
						th:text="${cartaBuscada.Nombre}"></a><br> <img
						th:src="@{${cartaBuscada.Imagen}}" th:width="80"> </span></td>
				<td th:text="${cartaBuscada.Ataque}" />
				<td th:text="${cartaBuscada.Defensa}" />
				<td th:text="${cartaBuscada.Coste}" />
				<td><span th:if="${cartaBuscada.Clase == 'Sin clase'}"
					th:style="'color:gray'"> <span>Sin clase</span>
				</span> <span th:unless="${cartaBuscada.Clase == 'Sin clase'}"> <span
						th:if="not ${cartaBuscada.Clase.matches('.*\s+.*')}"> <img
							th:src="@{'/images/classes/'+ ${cartaBuscada.Clase} + '.png'}"
							th:width="30">
					</span> <span th:unless="not ${cartaBuscada.Clase.matches('.*\s+.*')}">
							<span
							th:each="image,status : ${#strings.arraySplit(cartaBuscada.Clase, ', ')}">
								<span><img
									th:src="@{'/images/classes/' + ${image} + '.png'}"
									th:width="30"> </span>
						</span>
					</span>
				</span></td>
				<td th:text="${cartaBuscada.Tribus}" />


				<td><span
					th:if="not ${cartaBuscada.Atributos.matches('.*\s+.*')}"
					th:style="'color: white'"> <img
						th:src="@{'/images/abilities/'+ ${cartaBuscada.Atributos} + '.png'}"
						onerror="this.onerror=null; this.remove();" th:width="20"> <span
						th:text="${cartaBuscada.Atributos}" />
				</span> <span th:unless="not ${cartaBuscada.Atributos.matches('.*\s+.*')}">
						<span th:if="${cartaBuscada.Atributos}=='Sin atributos'"
						th:style="'color: gray'"> <span
							th:text="${cartaBuscada.Atributos}" />
					</span> <span th:unless="${cartaBuscada.Atributos}=='Sin atributos'">
							<span
							th:each="image,status : ${#strings.arraySplit(cartaBuscada.Atributos, ' ')}">
								<span> <span th:if="${image}=='Double'"> <img
										th:src="@{'/images/abilities/Double Strike.png'}"
										th:width="20">
								</span> <span th:unless="${image}=='Double'"> <img
										th:src="@{'/images/abilities/' + ${image} + '.png'}"
										onerror="this.onerror=null; this.remove();" th:width="20">
								</span> <span th:text="${image}" />
							</span>
						</span>
					</span>
				</span></td>

				<td><span
					th:if="${cartaBuscada.Habilidades}=='Sin habilidades'"
					th:style="'color: gray'"> <span
						th:text="${cartaBuscada.Habilidades}" />
				</span> <span th:unless="${cartaBuscada.Habilidades}=='Sin habilidades'"
					th:style="'color: white'"> <span
						th:if="not ${cartaBuscada.Habilidades.matches('.*%.*')}"> <span
							th:text="${cartaBuscada.Habilidades}" />
					</span> <span th:unless="not ${cartaBuscada.Habilidades.matches('.*%.*')}">
							<span
							th:if="${cartaBuscada.Habilidades.matches('.*%.*%.*%.*%.*')}">
								<!-- 4 IMAGENES --> <span
								th:with="indiceNombre=${#strings.indexOf(cartaBuscada.Habilidades,'%')}">
									<span
									th:with="indiceNombreFinal=${#strings.indexOf(cartaBuscada.Habilidades,'#')}">
										<span
										th:with="nombreImagen=${#strings.substring(cartaBuscada.Habilidades, indiceNombre+1, indiceNombreFinal)}">
											<span
											th:with="fragmentoFinal=${#strings.substring(cartaBuscada.Habilidades,indiceNombreFinal+1)}">
												<span
												th:text="${#strings.substring(cartaBuscada.Habilidades,0,indiceNombre)}"></span>
												<img
												th:src="@{'/images/abilities/' + ${nombreImagen} +'.png'}"
												onerror="this.onerror=null; this.remove();" th:width="30">
												<span th:if="${fragmentoFinal.matches('.*%.*')}"> <span
													th:with="indiceNombre2=${#strings.indexOf(fragmentoFinal,'%')}">
														<span
														th:with="indiceNombreFinal2=${#strings.indexOf(fragmentoFinal,'#')}">
															<span
															th:with="nombreImagen2=${#strings.substring(fragmentoFinal, indiceNombre2+1, indiceNombreFinal2)}">
																<span
																th:text="${#strings.substring(fragmentoFinal,0,indiceNombre2)}"></span>
																<img
																th:src="@{'/images/abilities/' + ${nombreImagen2} +'.png'}"
																onerror="this.onerror=null; this.remove();"
																th:width="30"> <span
																th:with="fragmentoFinal2=${#strings.substring(fragmentoFinal,indiceNombreFinal2+1)}">
																	<span th:if="${fragmentoFinal2.matches('.*%.*')}">
																		<span
																		th:with="indiceNombre3=${#strings.indexOf(fragmentoFinal2,'%')}">
																			<span
																			th:with="indiceNombreFinal3=${#strings.indexOf(fragmentoFinal2,'#')}">
																				<span
																				th:with="nombreImagen3=${#strings.substring(fragmentoFinal2, indiceNombre3+1, indiceNombreFinal3)}">
																					<span
																					th:with="fragmentoFinal3=${#strings.substring(fragmentoFinal2,indiceNombreFinal3)}">
																						<span
																						th:text="${#strings.substring(fragmentoFinal2,0,indiceNombre3)}"></span>
																						<img
																						th:src="@{'/images/abilities/' + ${nombreImagen3} +'.png'}"
																						onerror="this.onerror=null; this.remove();"
																						th:width="30"> <span
																						th:with="fragmentoFinal3=${#strings.substring(fragmentoFinal2,indiceNombreFinal3+1)}">
																							<span th:if="${fragmentoFinal3.matches('.*%.*')}">
																								<span
																								th:with="indiceNombre4=${#strings.indexOf(fragmentoFinal3,'%')}">
																									<span
																									th:with="indiceNombreFinal4=${#strings.indexOf(fragmentoFinal3,'#')}">
																										<span
																										th:with="nombreImagen4=${#strings.substring(fragmentoFinal3, indiceNombre4+1, indiceNombreFinal4)}">
																											<span
																											th:with="fragmentoFinal4=${#strings.substring(fragmentoFinal3,indiceNombreFinal4)}">
																												<span
																												th:text="${#strings.substring(fragmentoFinal3,0,indiceNombre4)}"></span>
																												<img
																												th:src="@{'/images/abilities/' + ${nombreImagen4} +'.png'}"
																												onerror="this.onerror=null; this.remove();"
																												th:width="30"> <span
																												th:text="${#strings.replace(fragmentoFinal4,'#','')} "></span>
																										</span>
																									</span>
																								</span>
																							</span>
																						</span> <span
																							th:unless="${fragmentoFinal3.matches('.*%.*')}">
																								<span
																								th:text="${#strings.replace(fragmentoFinal2,'#','')} "></span>
																						</span>
																					</span>
																				</span>
																			</span>
																		</span>
																	</span>
																</span>
															</span>
														</span>
													</span>
												</span>
											</span>
										</span>
									</span>
								</span>
							</span>
						</span> <span
							th:unless="${cartaBuscada.Habilidades.matches('.*%.*%.*%.*%.*')}">
								<span th:if="${cartaBuscada.Habilidades.matches('.*%.*%.*%.*')}">
									<!-- 3 IMAGENES --> <span
									th:with="indiceNombre=${#strings.indexOf(cartaBuscada.Habilidades,'%')}">
										<span
										th:with="indiceNombreFinal=${#strings.indexOf(cartaBuscada.Habilidades,'#')}">
											<span
											th:with="nombreImagen=${#strings.substring(cartaBuscada.Habilidades, indiceNombre+1, indiceNombreFinal)}">
												<span
												th:with="fragmentoFinal=${#strings.substring(cartaBuscada.Habilidades,indiceNombreFinal+1)}">
													<span
													th:text="${#strings.substring(cartaBuscada.Habilidades,0,indiceNombre)}"></span>
													<img
													th:src="@{'/images/abilities/' + ${nombreImagen} +'.png'}"
													onerror="this.onerror=null; this.remove();" th:width="30">
													<span th:if="${fragmentoFinal.matches('.*%.*')}"> <span
														th:with="indiceNombre2=${#strings.indexOf(fragmentoFinal,'%')}">
															<span
															th:with="indiceNombreFinal2=${#strings.indexOf(fragmentoFinal,'#')}">
																<span
																th:with="nombreImagen2=${#strings.substring(fragmentoFinal, indiceNombre2+1, indiceNombreFinal2)}">
																	<span
																	th:text="${#strings.substring(fragmentoFinal,0,indiceNombre2)}"></span>
																	<img
																	th:src="@{'/images/abilities/' + ${nombreImagen2} +'.png'}"
																	onerror="this.onerror=null; this.remove();"
																	th:width="30"> <span
																	th:with="fragmentoFinal2=${#strings.substring(fragmentoFinal,indiceNombreFinal2+1)}">
																		<span th:if="${fragmentoFinal2.matches('.*%.*')}">
																			<span
																			th:with="indiceNombre3=${#strings.indexOf(fragmentoFinal2,'%')}">
																				<span
																				th:with="indiceNombreFinal3=${#strings.indexOf(fragmentoFinal2,'#')}">
																					<span
																					th:with="nombreImagen3=${#strings.substring(fragmentoFinal2, indiceNombre3+1, indiceNombreFinal3)}">
																						<span
																						th:with="fragmentoFinal3=${#strings.substring(fragmentoFinal2,indiceNombreFinal3)}">
																							<span
																							th:text="${#strings.substring(fragmentoFinal2,0,indiceNombre3)}"></span>
																							<img
																							th:src="@{'/images/abilities/' + ${nombreImagen3} +'.png'}"
																							onerror="this.onerror=null; this.remove();"
																							th:width="30"> <span
																							th:text="${#strings.replace(fragmentoFinal3,'#','')} "></span>
																					</span>
																				</span>
																			</span>
																		</span>
																	</span> <span th:unless="${fragmentoFinal2.matches('.*%.*')}">
																			<span
																			th:text="${#strings.replace(fragmentoFinal2,'#','')} "></span>
																	</span>
																</span>
															</span>
														</span>
													</span>
												</span>
											</span>
										</span>
									</span>
								</span>
							</span> <span
								th:unless="${cartaBuscada.Habilidades.matches('.*%.*%.*%.*')}">
									<span th:if="${cartaBuscada.Habilidades.matches('.*%.*%.*')}">
										<!-- 2 IMAGENES --> <span
										th:with="indiceNombre=${#strings.indexOf(cartaBuscada.Habilidades,'%')}">
											<span
											th:with="indiceNombreFinal=${#strings.indexOf(cartaBuscada.Habilidades,'#')}">
												<span
												th:with="nombreImagen=${#strings.substring(cartaBuscada.Habilidades, indiceNombre+1, indiceNombreFinal)}">
													<span
													th:with="fragmentoFinal=${#strings.substring(cartaBuscada.Habilidades,indiceNombreFinal+1)}">
														<span
														th:text="${#strings.substring(cartaBuscada.Habilidades,0,indiceNombre)}"></span>
														<img
														th:src="@{'/images/abilities/' + ${nombreImagen} +'.png'}"
														onerror="this.onerror=null; this.remove();" th:width="30">
														<span th:if="${fragmentoFinal.matches('.*%.*')}"> <span
															th:with="indiceNombre2=${#strings.indexOf(fragmentoFinal,'%')}">
																<span
																th:with="indiceNombreFinal2=${#strings.indexOf(fragmentoFinal,'#')}">
																	<span
																	th:with="nombreImagen2=${#strings.substring(fragmentoFinal, indiceNombre2+1, indiceNombreFinal2)}">
																		<span
																		th:text="${#strings.substring(fragmentoFinal,0,indiceNombre2)}"></span>
																		<img
																		th:src="@{'/images/abilities/' + ${nombreImagen2} +'.png'}"
																		onerror="this.onerror=null; this.remove();"
																		th:width="30"> <span
																		th:with="fragmentoFinal2=${#strings.substring(fragmentoFinal,indiceNombreFinal2)}">
																			<span
																			th:text="${#strings.replace(fragmentoFinal2,'#','')} "></span>
																	</span>
																</span>
															</span>
														</span>
													</span>
												</span>
											</span>
										</span>
									</span>
								</span> <span
									th:unless="${cartaBuscada.Habilidades.matches('.*%.*%.*')}">
										<!-- SOLO UNA IMAGEN --> <span
										th:with="indiceNombre=${#strings.indexOf(cartaBuscada.Habilidades,'%')}">
											<span
											th:with="indiceNombreFinal=${#strings.indexOf(cartaBuscada.Habilidades,'#')}">
												<span
												th:with="nombreImagen=${#strings.substring(cartaBuscada.Habilidades, indiceNombre+1, indiceNombreFinal)}">
													<span
													th:with="fragmentoFinal=${#strings.substring(cartaBuscada.Habilidades,indiceNombreFinal+1)}">
														<span
														th:text="${#strings.substring(cartaBuscada.Habilidades,0,indiceNombre)}"></span>
														<img
														th:src="@{'/images/abilities/' + ${nombreImagen} +'.png'}"
														onerror="this.onerror=null; this.remove();" th:width="30">
														<span
														th:text="${#strings.substring(cartaBuscada.Habilidades,indiceNombreFinal+1)}"></span>
												</span>
											</span>
										</span>
									</span>
								</span>
							</span>
						</span>
					</span>
				</span></td>


				<td><span th:if="${cartaBuscada.Rareza}=='Sin rareza'"
					th:style="'color: gray'" /> <span
					th:unless="${cartaBuscada.Rareza}=='Sin rareza'"
					th:style="'color: white'" /><span th:text="${cartaBuscada.Rareza}"></span></td>

				<td><span th:if="${cartaBuscada.Mazo}=='Sin mazo'"
					th:style="'color: gray'" /> <span
					th:unless="${cartaBuscada.Mazo}=='Sin mazo'"
					th:style="'color: white'" /><span th:text="${cartaBuscada.Mazo}"></span></td>

				<td><span><img
						th:src="@{'/images/types/'+ ${cartaBuscada.Tipo} + '.png'}"
						th:width="40"></span></td>

				<div th:switch="${cartaBuscada.NumeroAtributos}">
					<td th:case="0" th:style="'background: firebrick;'"><span
						th:text=${cartaBuscada.NumeroAtributos} th:style="'color: black;'" /></td>
					<td th:case="1" th:style="'background: gold;'"><span
						th:text=${cartaBuscada.NumeroAtributos} th:style="'color: black;'" /></td>
					<td th:case="2" th:style="'background: limegreen;'"><span
						th:text=${cartaBuscada.NumeroAtributos} th:style="'color: black;'" /></td>
					<td th:case="*" th:style="'background: steelblue;'"><span
						th:text=${cartaBuscada.NumeroAtributos} th:style="'color: black;'" /></td>
				</div>
			</tr>
		</tbody>
	</table>
</body>

</html>